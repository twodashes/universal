{"version":3,"sources":["sort_objects.js"],"names":["sort_objects_by_property","arr","prop1_key","prop1_asc","immutable","sort","sort_objects_by_property__helper","bind","a","b","a_rating","b_rating","sort_objects_by_property_and_position","rating_key","multiply_position","that","obj","rate","min_rating","max_rating","i","delta_rating","median_rating","min_index","max_index","length","index","delta_index","sort_strings_by_rating_and_position__helper","a_index","window","browser","func","__"],"mappings":"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","file":"sort_objects.map","sourceRoot":"../esm","sourcesContent":["/**\n * Sort array of objects by property\n *    NOTE: this is just like _.sortBy() but can only sort by one property instead of multiple\n *    This is simply a simplified copy of `sort_objects_by_property_and_position()`\n *    ```\n *      let list = [{name:'Pasha',age:8}, {name:'Masha',age:9}]\n *      sort_objects_by_property(list, 'age') // Masha will move up to first place\n *    ```\n *    Like `sort_objects_by_property_and_position()`, but without caring about the position.\n *    NOTE: your original array will be modified. Use [...arr] destructuring to keep immutable.\n * @param arr {Array.<Object>} - array of objects to be sorted\n * @param prop1_key {string} - property to use, to sort by. Each object in array must contain this key\n * @param prop1_asc {boolean} - by default, will sort DESC, but if this is true, will sort ASC\n * @param immutable {boolean} - Set this to `true` to make this a pure function, and immutable.\n *    Otherwise, THIS IS NOT A PURE FUNCTION. By default it modifies the original array.\n * @return {Array.<Object>} - array of objects, sorted\n */\nfunction sort_objects_by_property(arr, prop1_key, prop1_asc = false, immutable=false) {\n  if (!arr) return []\n  if (immutable) arr = [...arr];\n  return arr.sort(sort_objects_by_property__helper.bind({ arr, prop1_key, prop1_asc }));\n}// helper function:\nfunction sort_objects_by_property__helper(a, b) {\n  // sort by rating\n  let a_rating = a[this.prop1_key];\n  let b_rating = b[this.prop1_key];\n  // sort order\n  if (this.prop1_asc) {\n    // prefer lower number\n    // if b is lower, then rate it better than a\n    return a_rating - b_rating;\n  } else {\n    // prefer higher number\n    // if b is higher, then rate it better than a\n    return b_rating - a_rating;\n  }\n}\n\n/**\n * Sort array of strings by separate dictionary of [{string:rating},], and\n * also by position in array. Items at front of array will be rated higher.\n * @param arr {Array.<String>} - array of strings\n * @param rating_key {string} - which property of object to use as sort rating (must be a number)\n * @param multiply_position {number} - make position x times more important than rating\n * @param immutable {boolean} - Set this to `true` to make this a pure function, and immutable.\n *    Otherwise, THIS IS NOT A PURE FUNCTION. By default it modifies the original array.\n * @return {Array.<String>} - array of strings\n */\nfunction sort_objects_by_property_and_position (arr, rating_key, multiply_position = 1, immutable=false) {\n  if (!arr) return []\n  if (immutable) arr = [...arr];\n  let that = {};\n\n  // rating_key\n  that.min_rating = null;\n  that.max_rating = null;\n  that.rating_key = rating_key;\n  for (let obj of arr) {\n    let rate = obj[rating_key];\n    // compare ratings to each other\n    if (that.min_rating === null || rate < that.min_rating) {\n      that.min_rating = rate;\n    }\n    if (that.max_rating === null || rate > that.max_rating) {\n      that.max_rating = rate;\n    }\n  }\n  that.delta_rating = that.max_rating - that.min_rating;\n  that.median_rating = that.min_rating + (that.delta_rating/2);\n\n  // prepare position\n  that.min_index = 0;\n  that.max_index = arr.length - 1;\n  for (let i in arr) {\n    // count up - first item = 0, last item = (length-1)\n    arr[i].index = i;\n  }\n  that.delta_index = that.max_index - that.min_index;\n  that.multiply_position = multiply_position;\n\n  // sort\n  return arr.sort(sort_strings_by_rating_and_position__helper.bind(that))\n}\n// helper function:\nfunction sort_strings_by_rating_and_position__helper(a, b) {\n\n  // higher == better\n  // normalized to 0-1 range\n  // highest rating gets 1, lowest rating gets 0\n  let a_rating = (this.delta_rating - (this.max_rating - (typeof a[this.rating_key]!=='undefined' ? a[this.rating_key] : this.median_rating))) / this.delta_rating;\n  let b_rating = (this.delta_rating - (this.max_rating - (typeof b[this.rating_key]!=='undefined' ? b[this.rating_key] : this.median_rating))) / this.delta_rating;\n\n  // higher == better\n  // normalized to 0-1 range\n  // lowest index gets 1, highest index gets 0\n  // (multiply_position to make position score more important than rating score)\n  let a_index = ((this.max_index - a.index) / this.delta_index) * this.multiply_position;\n  let b_index = ((this.max_index - b.index) / this.delta_index) * this.multiply_position;\n\n  // combine the two\n  // if b is higher, then sort it closer to front of array compared to a\n  return (b_rating + b_index) - (a_rating + a_index)\n}\n\n/*\n * EXPORT FOR BROWSER\n */\nif (typeof window === \"object\") {\n  const browser = { sort_objects_by_property, sort_objects_by_property_and_position };\n  // set up for export\n  window.__ = window.__ || {};\n  // flatten\n  for (let func in browser) {\n    window.__[func] = browser[func];\n  }\n}\n\nexport { sort_objects_by_property, sort_objects_by_property_and_position };\n"]}